#!/bin/bash
# Pre-commit hook: run cargo fmt and cargo test before commit

# Run cargo fmt check
if ! cargo fmt --check > /dev/null 2>&1; then
    echo "âŒ Code not formatted. Running cargo fmt..."
    cargo fmt
    echo ""
    echo "Files formatted. Please stage changes and commit again:"
    echo "  git add -A && git commit"
    exit 1
fi

echo "âœ… Code formatting OK"

# Run cargo test
echo "ğŸ§ª Running tests..."
if ! cargo test --quiet 2>&1 | tail -5; then
    echo "âŒ Tests failed. Please fix before committing."
    exit 1
fi

echo "âœ… All tests passed"
