   Compiling zero_x_infinity v0.1.0 (/Users/gjwang/eclipse-workspace/rust_source/zero_x_infinity)
warning: unexpected `cfg` condition value: `openapi`
   --> src/persistence/queries.rs:103:12
    |
103 | #[cfg_attr(feature = "openapi", derive(utoipa::ToSchema))]
    |            ^^^^^^^^^^^^^^^^^^^ help: remove the condition
    |
    = note: no expected values for `feature`
    = help: consider adding `openapi` as a feature in `Cargo.toml`
    = note: see <https://doc.rust-lang.org/nightly/rustc/check-cfg/cargo-specifics.html> for more information about checking conditional configuration
    = note: `#[warn(unexpected_cfgs)]` on by default

warning: unused import: `rust_decimal::prelude::FromPrimitive`
  --> src/websocket/service.rs:13:5
   |
13 | use rust_decimal::prelude::FromPrimitive; // Needed for u64 conversion
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: unused variable: `quote_decimals`
   --> src/websocket/service.rs:247:27
    |
247 |                      let (quote_decimals, quote_display_decimals) = symbol_info
    |                           ^^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_quote_decimals`
    |
    = note: `#[warn(unused_variables)]` (part of `#[warn(unused)]`) on by default

warning: unused variable: `json`
   --> src/websocket/connection.rs:134:17
    |
134 |             let json = serde_json::to_string(&message).unwrap_or_default();
    |                 ^^^^ help: if this is intentional, prefix it with an underscore: `_json`

warning: `zero_x_infinity` (lib) generated 4 warnings (run `cargo fix --lib -p zero_x_infinity` to apply 3 suggestions)
    Finished `release` profile [optimized] target(s) in 36.58s
     Running `target/release/zero_x_infinity --gateway --port 8080`
[2m2025-12-27T08:08:12.309367Z[0m [32m INFO[0m Starting 0xInfinity Engine in dev mode
=== 0xInfinity: Chapter 9a - Gateway Mode ===
Loaded 3 assets from fixtures/assets_config.csv
Loaded 2 symbols from fixtures/symbols_config.csv
Active symbol: BTC_USDT (base=BTC, quote=USDT)
  Internal decimals: base=8
  Max tradeable @ $100000: 18446.74 BTC per order (u64 safe)
Gateway will listen on 0.0.0.0:8080
Active symbol: BTC_USDT
Order queue size: 10000

[Persistence] Connecting to TDengine...
[2m2025-12-27T08:08:12.315874Z[0m [32m INFO[0m Connected to TDengine: taos+ws://root:taosdata@localhost:6041
[2m2025-12-27T08:08:12.315920Z[0m [32m INFO[0m Initializing TDengine schema...
[2m2025-12-27T08:08:12.319258Z[0m [34mDEBUG[0m handshake request
GET /ws HTTP/1.1
Host: localhost:6041
Upgrade: websocket
Connection: Upgrade
Sec-Websocket-Key: 6HMpsdoaRPiPJfe+S5ZZ1A==
Sec-WebSocket-Version: 13
Accept-Encoding: gzip


[2m2025-12-27T08:08:12.325904Z[0m [34mDEBUG[0m protocol handshake complete
[2m2025-12-27T08:08:12.325937Z[0m [34mDEBUG[0m handshake response Response { status: 101, version: HTTP/1.1, headers: {"upgrade": "websocket", "connection": "Upgrade", "sec-websocket-accept": "JcFZegXcAIrRNh+IRsUHhO+RbJ4="}, body: () }
[2m2025-12-27T08:08:12.325950Z[0m [34mDEBUG[0m use deflate config: None
[2m2025-12-27T08:08:12.336698Z[0m [32m INFO[0m âœ… TDengine database precision: us (correct)
[2m2025-12-27T08:08:12.343594Z[0m [32m INFO[0m TDengine schema initialized successfully
âœ… TDengine connected and schema initialized
[2m2025-12-27T08:08:12.343633Z[0m [32m INFO[0m Creating K-Line streams...
[2m2025-12-27T08:08:12.346694Z[0m [32m INFO[0m Created stream: kline_1m_stream
[2m2025-12-27T08:08:12.348396Z[0m [32m INFO[0m Created stream: kline_5m_stream
[2m2025-12-27T08:08:12.349763Z[0m [32m INFO[0m Created stream: kline_15m_stream
[2m2025-12-27T08:08:12.351113Z[0m [32m INFO[0m Created stream: kline_30m_stream
[2m2025-12-27T08:08:12.352318Z[0m [32m INFO[0m Created stream: kline_1h_stream
[2m2025-12-27T08:08:12.353541Z[0m [32m INFO[0m Created stream: kline_1d_stream
[2m2025-12-27T08:08:12.353556Z[0m [32m INFO[0m K-Line streams setup complete
âœ… K-Line streams created
[2m2025-12-27T08:08:12.353579Z[0m [32m INFO[0m Pre-creating subtables for 2 symbols...
[2m2025-12-27T08:08:12.372764Z[0m [34mDEBUG[0m Pre-created subtables for symbol_id=1
[2m2025-12-27T08:08:12.373275Z[0m [34mDEBUG[0m Pre-created subtables for symbol_id=0
[2m2025-12-27T08:08:12.373297Z[0m [32m INFO[0m All symbol subtables pre-creation finished
âœ… Symbol subtables pre-created

[Account] Connecting to PostgreSQL...
[2m2025-12-27T08:08:12.384544Z[0m [32m INFO[0m PostgreSQL connection pool established
âœ… PostgreSQL connected
[2m2025-12-27T08:08:12.389359Z[0m [34mDEBUG[0m [3msummary[0m[2m=[0m"SELECT asset_id, asset, name, â€¦" [3mdb.statement[0m[2m=[0m"\n\nSELECT asset_id, asset, name, decimals, status, asset_flags \n               FROM assets_tb WHERE status = 1\n" [3mrows_affected[0m[2m=[0m4 [3mrows_returned[0m[2m=[0m4 [3melapsed[0m[2m=[0m4.251709ms [3melapsed_secs[0m[2m=[0m0.004251709
âœ… Loaded 4 assets
[2m2025-12-27T08:08:12.396579Z[0m [34mDEBUG[0m [3msummary[0m[2m=[0m"SELECT symbol_id, symbol, base_asset_id, â€¦" [3mdb.statement[0m[2m=[0m"\n\nSELECT symbol_id, symbol, base_asset_id, quote_asset_id,\n                      price_decimals, qty_decimals, min_qty, status, symbol_flags,\n                      base_maker_fee, base_taker_fee\n               FROM symbols_tb WHERE status = 1\n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m1.42375ms [3melapsed_secs[0m[2m=[0m0.00142375
âœ… Loaded 1 symbols
ðŸ”„ TransferChannel created (buffer=1024)

[1] Initializing Trading Core...
Loaded balances for 1002 accounts (row-based format)
[2m2025-12-27T08:08:12.398019Z[0m [32m INFO[0m [UBSCore] Persistence enabled: data_dir=./data/ubscore
[2m2025-12-27T08:08:12.398042Z[0m [32m INFO[0m No snapshot found, cold start
[2m2025-12-27T08:08:12.398084Z[0m [32m INFO[0m Replayed WAL [3mfrom_seq[0m[2m=[0m1 [3mto_seq[0m[2m=[0m0

[Persistence] Pre-creating 2004 balance tables...
   Progress: 500/2004 tables...
   Progress: 1000/2004 tables...
   Progress: 1500/2004 tables...
   Progress: 2000/2004 tables...
âœ… Balance tables pre-created for 1002 users
ðŸš€ Gateway thread started
âœ… Trading Core initialized

ðŸŽ¯ System ready! Send orders to http://localhost:8080/api/v1/private/order
Press Ctrl+C to shutdown

[2m2025-12-27T08:08:12.792108Z[0m [32m INFO[0m [TRACE] Starting Multi-Thread Pipeline with 0 orders...
[2m2025-12-27T08:08:12.792148Z[0m [32m INFO[0m [ME] Persistence enabled: dir=./data/matching, snapshot_interval=1000
[2m2025-12-27T08:08:12.792219Z[0m [32m INFO[0m No snapshot found, cold start with empty OrderBook
[2m2025-12-27T08:08:12.792243Z[0m [32m INFO[0m MatchingService recovery complete: next_seq_id=1
ðŸ“Š DepthService started
[2m2025-12-27T08:08:12.792329Z[0m [32m INFO[0m ME Synchronization starting [3mfrom_seq[0m[2m=[0m1
ðŸ“¡ WebSocket push service started
  â†’ TradingAdapter connected to UBSCore via TransferChannel
ðŸ”„ Transfer FSM coordinator initialized
[2m2025-12-27T08:08:12.792374Z[0m [32m INFO[0m ME Synchronization complete
[2m2025-12-27T08:08:12.792366Z[0m [32m INFO[0m [WsService] Started - polling push_event_queue
[2m2025-12-27T08:08:12.792389Z[0m [32m INFO[0m [Settlement] Persistence enabled: dir=./data/settlement, checkpoint_interval=1000, snapshot_interval=10000
[2m2025-12-27T08:08:12.792470Z[0m [32m INFO[0m Settlement cold start: no snapshot found
[2m2025-12-27T08:08:12.792493Z[0m [34mDEBUG[0m WAL is empty
[2m2025-12-27T08:08:12.792539Z[0m [32m INFO[0m Settlement recovery complete [3mlast_trade_id[0m[2m=[0m0 [3mis_cold_start[0m[2m=[0mtrue
[2m2025-12-27T08:08:12.792548Z[0m [32m INFO[0m SettlementService recovery complete [3mlast_trade_id[0m[2m=[0m0 [3mis_cold_start[0m[2m=[0mtrue
[2m2025-12-27T08:08:12.792601Z[0m [32m INFO[0m Settlement Synchronization starting [3mlast_trade_id[0m[2m=[0m0
[2m2025-12-27T08:08:12.792626Z[0m [32m INFO[0m Settlement Synchronization complete
[2m2025-12-27T08:08:12.792941Z[0m [32m INFO[0m [TRACE] Pipeline executing in CONTINUOUS mode (ctrl+c to stop)
[2m2025-12-27T08:08:12.792962Z[0m [32m INFO[0m [TRACE] UBSCoreService thread started
ðŸš€ Gateway listening on http://0.0.0.0:8080
ðŸ“¡ WebSocket endpoint: ws://0.0.0.0:8080/ws
ðŸ“– API Docs: http://0.0.0.0:8080/docs
ðŸ“‚ Public API:  /api/v1/public/*
ðŸ”’ Private API: /api/v1/private/* (auth required)
[2m2025-12-27T08:08:22.430748Z[0m [32m INFO[0m WebSocket connection added [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m1 [3mtotal_connections[0m[2m=[0m1
[2m2025-12-27T08:08:22.430983Z[0m [32m INFO[0m WebSocket connection added [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m1 [3mtotal_connections[0m[2m=[0m1
[2m2025-12-27T08:08:32.436703Z[0m [34mDEBUG[0m Received close frame: Some(CloseFrame { code: Normal, reason: Utf8Bytes(b"") })
[2m2025-12-27T08:08:32.437034Z[0m [34mDEBUG[0m Replying to close with Frame { header: FrameHeader { is_final: true, rsv1: false, rsv2: false, rsv3: false, opcode: Control(Close), mask: None }, payload: b"\x03\xe8" }
[2m2025-12-27T08:08:32.437065Z[0m [32m INFO[0m All WebSocket connections closed [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m1
[2m2025-12-27T08:08:59.679551Z[0m [32m INFO[0m WebSocket connection added [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m2 [3mtotal_connections[0m[2m=[0m1
[2m2025-12-27T08:08:59.679634Z[0m [32m INFO[0m WebSocket connection added [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m2 [3mtotal_connections[0m[2m=[0m1
[2m2025-12-27T08:08:59.683243Z[0m [34mDEBUG[0m Received close frame: Some(CloseFrame { code: Normal, reason: Utf8Bytes(b"") })
[2m2025-12-27T08:08:59.683276Z[0m [34mDEBUG[0m Replying to close with Frame { header: FrameHeader { is_final: true, rsv1: false, rsv2: false, rsv3: false, opcode: Control(Close), mask: None }, payload: b"\x03\xe8" }
[2m2025-12-27T08:08:59.683329Z[0m [32m INFO[0m All WebSocket connections closed [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m2
[2m2025-12-27T08:09:43.419699Z[0m [32m INFO[0m WebSocket connection added [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m3 [3mtotal_connections[0m[2m=[0m1
[2m2025-12-27T08:09:43.419745Z[0m [32m INFO[0m WebSocket connection added [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m3 [3mtotal_connections[0m[2m=[0m1
[2m2025-12-27T08:09:43.430849Z[0m [34mDEBUG[0m [3msummary[0m[2m=[0m"SELECT key_id, user_id, api_key, â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT key_id, user_id, api_key, key_type, key_data, label, \n                   permissions, status, last_ts_nonce\n            FROM api_keys_tb \n            WHERE api_key = $1 AND status = 1\n            \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m6.0295ms [3melapsed_secs[0m[2m=[0m0.0060295
[DEBUG] Auth payload: api_key=AK_0000000000001002, ts_nonce=1766822983420, method=POST, uri=/api/v1/private/order
[2m2025-12-27T08:09:43.431115Z[0m [32m INFO[0m [TRACE] Create Order: Received from User 1002
[2m2025-12-27T08:09:43.431158Z[0m [32m INFO[0m [TRACE] Create Order 1: Pushing to Ingestion Queue
[2m2025-12-27T08:09:43.431168Z[0m [32m INFO[0m [TRACE] Create Order 1: âœ… Pushed to Ingestion Queue
[2m2025-12-27T08:09:43.431297Z[0m [32m INFO[0m [TRACE] UBSC: Popped action from order_queue
[2m2025-12-27T08:09:43.431345Z[0m [32m INFO[0m [TRACE] Order 1: UBSCore Processed (Locked & Validated)
[2m2025-12-27T08:09:43.431402Z[0m [32m INFO[0m [TRACE] Order 1: UBSCore -> Push Event Queue (NEW)
[2m2025-12-27T08:09:43.431619Z[0m [32m INFO[0m [1mORDER[0m[1m{[0morder_id=1[1m}[0m[2m:[0m [TRACE] Order 1: Matching Engine Processed (Trades: 0)
[2m2025-12-27T08:09:43.431632Z[0m [32m INFO[0m [1mORDER[0m[1m{[0morder_id=1[1m}[0m[2m:[0m Matching completed [3mtrades[0m[2m=[0m0
[2m2025-12-27T08:09:43.431745Z[0m [34mDEBUG[0m Received close frame: Some(CloseFrame { code: Normal, reason: Utf8Bytes(b"") })
[2m2025-12-27T08:09:43.431757Z[0m [34mDEBUG[0m Replying to close with Frame { header: FrameHeader { is_final: true, rsv1: false, rsv2: false, rsv3: false, opcode: Control(Close), mask: None }, payload: b"\x03\xe8" }
[2m2025-12-27T08:09:43.431790Z[0m [32m INFO[0m All WebSocket connections closed [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m3
[WsService] Popped event from queue: count=1
[WsService] Handling event: OrderUpdate { user_id: 1002, order_id: 1, symbol_id: 0, status: NEW, filled_qty: 0, avg_price: None }
[WsService] Popped event from queue: count=1
[WsService] Handling event: OrderUpdate { user_id: 1002, order_id: 1, symbol_id: 0, status: NEW, filled_qty: 0, avg_price: None }
[2m2025-12-27T08:09:43.441892Z[0m [33m WARN[0m [PROFILE] async_balance_persist=8ms count=1
[WsService] Popped event from queue: count=1
[WsService] Handling event: BalanceUpdate { user_id: 1002, asset_id: 1, avail: 9990000000, frozen: 10000000 }
[2m2025-12-27T08:10:04.744850Z[0m [32m INFO[0m WebSocket connection added [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m4 [3mtotal_connections[0m[2m=[0m1
[2m2025-12-27T08:10:04.744898Z[0m [32m INFO[0m WebSocket connection added [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m4 [3mtotal_connections[0m[2m=[0m1
[2m2025-12-27T08:10:04.755264Z[0m [34mDEBUG[0m [3msummary[0m[2m=[0m"SELECT key_id, user_id, api_key, â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT key_id, user_id, api_key, key_type, key_data, label, \n                   permissions, status, last_ts_nonce\n            FROM api_keys_tb \n            WHERE api_key = $1 AND status = 1\n            \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m5.044125ms [3melapsed_secs[0m[2m=[0m0.005044125
[DEBUG] Auth payload: api_key=AK_0000000000001002, ts_nonce=1766823004745, method=POST, uri=/api/v1/private/order
[2m2025-12-27T08:10:04.755427Z[0m [32m INFO[0m [TRACE] Create Order: Received from User 1002
[2m2025-12-27T08:10:04.755436Z[0m [32m INFO[0m [TRACE] Create Order 2: Pushing to Ingestion Queue
[2m2025-12-27T08:10:04.755447Z[0m [32m INFO[0m [TRACE] Create Order 2: âœ… Pushed to Ingestion Queue
[2m2025-12-27T08:10:04.755475Z[0m [32m INFO[0m [TRACE] UBSC: Popped action from order_queue
[2m2025-12-27T08:10:04.755495Z[0m [32m INFO[0m [TRACE] Order 2: UBSCore Processed (Locked & Validated)
[2m2025-12-27T08:10:04.755714Z[0m [32m INFO[0m [TRACE] Order 2: UBSCore -> Push Event Queue (NEW)
[2m2025-12-27T08:10:04.755858Z[0m [32m INFO[0m [1mORDER[0m[1m{[0morder_id=2[1m}[0m[2m:[0m [TRACE] Order 2: Matching Engine Processed (Trades: 0)
[2m2025-12-27T08:10:04.755873Z[0m [32m INFO[0m [1mORDER[0m[1m{[0morder_id=2[1m}[0m[2m:[0m Matching completed [3mtrades[0m[2m=[0m0
[WsService] Popped event from queue: count=1
[WsService] Handling event: OrderUpdate { user_id: 1002, order_id: 2, symbol_id: 0, status: NEW, filled_qty: 0, avg_price: None }
[2m2025-12-27T08:10:04.756261Z[0m [34mDEBUG[0m Received close frame: Some(CloseFrame { code: Normal, reason: Utf8Bytes(b"") })
[2m2025-12-27T08:10:04.756277Z[0m [34mDEBUG[0m Replying to close with Frame { header: FrameHeader { is_final: true, rsv1: false, rsv2: false, rsv3: false, opcode: Control(Close), mask: None }, payload: b"\x03\xe8" }
[2m2025-12-27T08:10:04.756299Z[0m [32m INFO[0m All WebSocket connections closed [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m4
[WsService] Popped event from queue: count=1
[WsService] Handling event: OrderUpdate { user_id: 1002, order_id: 2, symbol_id: 0, status: NEW, filled_qty: 0, avg_price: None }
[WsService] Popped event from queue: count=1
[WsService] Handling event: BalanceUpdate { user_id: 1002, asset_id: 1, avail: 9980000000, frozen: 20000000 }
[2m2025-12-27T08:10:26.348300Z[0m [32m INFO[0m WebSocket connection added [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m5 [3mtotal_connections[0m[2m=[0m1
[2m2025-12-27T08:10:26.348340Z[0m [32m INFO[0m WebSocket connection added [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m5 [3mtotal_connections[0m[2m=[0m1
[2m2025-12-27T08:10:26.355993Z[0m [34mDEBUG[0m [3msummary[0m[2m=[0m"SELECT key_id, user_id, api_key, â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT key_id, user_id, api_key, key_type, key_data, label, \n                   permissions, status, last_ts_nonce\n            FROM api_keys_tb \n            WHERE api_key = $1 AND status = 1\n            \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m2.817083ms [3melapsed_secs[0m[2m=[0m0.002817083
[DEBUG] Auth payload: api_key=AK_0000000000001002, ts_nonce=1766823026349, method=POST, uri=/api/v1/private/order
[2m2025-12-27T08:10:26.356148Z[0m [32m INFO[0m [TRACE] Create Order: Received from User 1002
[2m2025-12-27T08:10:26.356155Z[0m [32m INFO[0m [TRACE] Create Order 3: Pushing to Ingestion Queue
[2m2025-12-27T08:10:26.356159Z[0m [32m INFO[0m [TRACE] Create Order 3: âœ… Pushed to Ingestion Queue
[2m2025-12-27T08:10:26.356191Z[0m [32m INFO[0m [TRACE] UBSC: Popped action from order_queue
[2m2025-12-27T08:10:26.356242Z[0m [32m INFO[0m [TRACE] Order 3: UBSCore Processed (Locked & Validated)
[2m2025-12-27T08:10:26.356464Z[0m [32m INFO[0m [TRACE] Order 3: UBSCore -> Push Event Queue (NEW)
[2m2025-12-27T08:10:26.356574Z[0m [32m INFO[0m [1mORDER[0m[1m{[0morder_id=3[1m}[0m[2m:[0m [TRACE] Order 3: Matching Engine Processed (Trades: 0)
[2m2025-12-27T08:10:26.356580Z[0m [32m INFO[0m [1mORDER[0m[1m{[0morder_id=3[1m}[0m[2m:[0m Matching completed [3mtrades[0m[2m=[0m0
[WsService] Popped event from queue: count=1
[WsService] Handling event: OrderUpdate { user_id: 1002, order_id: 3, symbol_id: 0, status: NEW, filled_qty: 0, avg_price: None }
[2m2025-12-27T08:10:26.361286Z[0m [34mDEBUG[0m [3msummary[0m[2m=[0m"SELECT key_id, user_id, api_key, â€¦" [3mdb.statement[0m[2m=[0m"\n\n\n            SELECT key_id, user_id, api_key, key_type, key_data, label, \n                   permissions, status, last_ts_nonce\n            FROM api_keys_tb \n            WHERE api_key = $1 AND status = 1\n            \n" [3mrows_affected[0m[2m=[0m1 [3mrows_returned[0m[2m=[0m1 [3melapsed[0m[2m=[0m1.674792ms [3melapsed_secs[0m[2m=[0m0.001674792
[DEBUG] Auth payload: api_key=AK_0000000000001001, ts_nonce=1766823026356, method=POST, uri=/api/v1/private/order
[2m2025-12-27T08:10:26.361410Z[0m [32m INFO[0m [TRACE] Create Order: Received from User 1001
[2m2025-12-27T08:10:26.361417Z[0m [32m INFO[0m [TRACE] Create Order 4: Pushing to Ingestion Queue
[2m2025-12-27T08:10:26.361420Z[0m [32m INFO[0m [TRACE] Create Order 4: âœ… Pushed to Ingestion Queue
[2m2025-12-27T08:10:26.361489Z[0m [32m INFO[0m [TRACE] UBSC: Popped action from order_queue
[2m2025-12-27T08:10:26.361509Z[0m [32m INFO[0m [TRACE] Order 4: UBSCore Processed (Locked & Validated)
[2m2025-12-27T08:10:26.361526Z[0m [32m INFO[0m [TRACE] Order 4: UBSCore -> Push Event Queue (NEW)
[2m2025-12-27T08:10:26.361580Z[0m [32m INFO[0m [1mORDER[0m[1m{[0morder_id=4[1m}[0m[2m:[0m [TRACE] Order 4: Matching Engine Processed (Trades: 1)
[2m2025-12-27T08:10:26.361586Z[0m [32m INFO[0m [1mORDER[0m[1m{[0morder_id=4[1m}[0m[2m:[0m Matching completed [3mtrades[0m[2m=[0m1
[WsService] Popped event from queue: count=1
[WsService] Handling event: OrderUpdate { user_id: 1001, order_id: 4, symbol_id: 0, status: NEW, filled_qty: 0, avg_price: None }
[WsService] Popped event from queue: count=1
[WsService] Handling event: OrderUpdate { user_id: 1002, order_id: 3, symbol_id: 0, status: NEW, filled_qty: 0, avg_price: None }
[WsService] Popped event from queue: count=2
[WsService] Handling event: BalanceUpdate { user_id: 1002, asset_id: 1, avail: 9970000000, frozen: 30000000 }
[WsService] Popped event from queue: count=1
[WsService] Handling event: OrderUpdate { user_id: 1001, order_id: 4, symbol_id: 0, status: FILLED, filled_qty: 10000000, avg_price: Some(5000000) }
[WsService] Popped event from queue: count=2
[WsService] Handling event: OrderUpdate { user_id: 1002, order_id: 1, symbol_id: 0, status: FILLED, filled_qty: 0, avg_price: Some(5000000) }
[WsService] Popped event from queue: count=3
[WsService] Handling event: Trade { user_id: 1001, trade_id: 1, order_id: 4, symbol_id: 0, side: Buy, price: 5000000, qty: 10000000, fee: 2000, fee_asset_id: 1, is_maker: false }
[WsService] Popped event from queue: count=4
[WsService] Handling event: Trade { user_id: 1002, trade_id: 1, order_id: 1, symbol_id: 0, side: Sell, price: 5000000, qty: 10000000, fee: 50, fee_asset_id: 2, is_maker: true }
[2m2025-12-27T08:10:26.366928Z[0m [34mDEBUG[0m Received close frame: Some(CloseFrame { code: Normal, reason: Utf8Bytes(b"") })
[2m2025-12-27T08:10:26.366940Z[0m [34mDEBUG[0m Replying to close with Frame { header: FrameHeader { is_final: true, rsv1: false, rsv2: false, rsv3: false, opcode: Control(Close), mask: None }, payload: b"\x03\xe8" }
[2m2025-12-27T08:10:26.366959Z[0m [32m INFO[0m All WebSocket connections closed [3muser_id[0m[2m=[0m0 [3mconn_id[0m[2m=[0m5
[WsService] Popped event from queue: count=1
[WsService] Handling event: BalanceUpdate { user_id: 1001, asset_id: 2, avail: 999500000, frozen: 500000 }
[WsService] Popped event from queue: count=2
[WsService] Handling event: BalanceUpdate { user_id: 1001, asset_id: 2, avail: 999500000, frozen: 0 }
[WsService] Popped event from queue: count=3
[WsService] Handling event: BalanceUpdate { user_id: 1001, asset_id: 1, avail: 10009998000, frozen: 0 }
[WsService] Popped event from queue: count=4
[WsService] Handling event: BalanceUpdate { user_id: 1002, asset_id: 1, avail: 9970000000, frozen: 20000000 }
[WsService] Popped event from queue: count=5
[WsService] Handling event: BalanceUpdate { user_id: 1002, asset_id: 2, avail: 1000499950, frozen: 0 }
[WsService] Popped event from queue: count=6
[WsService] Handling event: BalanceUpdate { user_id: 0, asset_id: 1, avail: 2000, frozen: 0 }
[WsService] Popped event from queue: count=7
[WsService] Handling event: BalanceUpdate { user_id: 0, asset_id: 2, avail: 50, frozen: 0 }
